{% extends "ui/templates/base.html" %}
{% import 'admin/lib.html' as lib with context %}

{% macro extra() %}
  <input name="_continue_editing" type="submit" class="btn" value="{{ _gettext('Save and Continue') }}" />
{% endmacro %}

{% block head %}
    {{ super() }}
    {{ lib.form_css() }}
{% endblock %}

{%block body%}
<ul class="nav nav-tabs" role="tablist" id="myTab">
  <li class="active"><a href="#main" role="tab" data-toggle="tab">Camera Status</a></li>
  <li><a href="#init" role="tab" data-toggle="tab">Edit Camera Settings</a></li>
  <li><a href="#run" role="tab" data-toggle="tab">Create Run Settings</a></li>
</ul>

<div class="tab-content">

    <div class="tab-pane active" id="main">
        <div id="server_ctl" class="panel
    			{% if status['ok']  %}
				panel-success
			{% else %}
				panel-danger
			{% endif %}
        " style="margin-top: 15px">
        	<div class="panel-heading"><div class="panel-title">PhenoCam Status and Control</div></div>
        	<div class="panel-body">
        		<div id='server_status' class='pull-left'>
        				<span class="glyphicon glyphicon-ok"></span>
        				<span class="status_msg">&nbsp;{{ status['msg']  }}</span>	
        		</div>
        		<div id='server_ctl_btns'  class='pull-right'>
        				<a class="btn btn-primary" href="/phenocam/?action=reinit"><span class="glyphicon glyphicon-wrench"></span> Initalize</a>
                              <a class="btn btn-primary" href="/phenocam/?action=status"><span class="glyphicon glyphicon-tasks"></span> Status</a>
        				<a class="btn btn-primary" href="/phenocam/?action=test"><span class="glyphicon glyphicon-picture"></span> Test</a>
        		</div>
        	</div>
        </div>
        
    </div>
    
    <div class="tab-pane" id="init">
        <h4/> PhenoCam Initalizaton Settings </h4>
            {% call lib.form_tag(init_form) %}
                {{ lib.render_form_fields(init_form, form_opts=form_opts) }}
                {{ lib.render_form_buttons(return_url, extra()) }}
            {% endcall %}
    </div>
    
    <div class="tab-pane" id="run">
        <h4> Create PhenoCam Run Settings </h4>
            {% call lib.form_tag(run_list) %}
                {{ lib.render_form_fields(run_list, form_opts=list_opts) }}
            {% endcall %}
            {% call lib.form_tag(run_form) %}
                {{ lib.render_form_fields(run_form, form_opts=form_opts) }}
                {{ lib.render_form_buttons(return_url, extra()) }}
            {% endcall %}
    </div>

</div>
{% endblock %}

{% block tail %}
  {{ super() }}
  {{ lib.form_js() }}
<script>
  $(function () {
    $('#myTab a[href="#{{active_tab}}"]').tab('show')
  })
</script>
{% endblock %}